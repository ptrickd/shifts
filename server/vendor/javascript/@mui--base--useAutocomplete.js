import e from"@babel/runtime/helpers/esm/extends";import*as t from"react";import{unstable_useId as n,unstable_useControlled as o,usePreviousProps as r,unstable_useEventCallback as s,unstable_setRef as i}from"@mui/utils";"use client";function stripDiacritics(e){return typeof e.normalize!=="undefined"?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e}function createFilterOptions(e={}){const{ignoreAccents:t=true,ignoreCase:n=true,limit:o,matchFrom:r="any",stringify:s,trim:i=false}=e;return(e,{inputValue:l,getOptionLabel:a})=>{let u=i?l.trim():l;n&&(u=u.toLowerCase());t&&(u=stripDiacritics(u));const c=u?e.filter((e=>{let o=(s||a)(e);n&&(o=o.toLowerCase());t&&(o=stripDiacritics(o));return r==="start"?o.indexOf(u)===0:o.indexOf(u)>-1})):e;return typeof o==="number"?c.slice(0,o):c}}function findIndex(e,t){for(let n=0;n<e.length;n+=1)if(t(e[n]))return n;return-1}const l=createFilterOptions();const a=5;const defaultIsActiveElementInListbox=e=>{var t;return e.current!==null&&((t=e.current.parentElement)==null?void 0:t.contains(document.activeElement))};function useAutocomplete(u){const{unstable_isActiveElementInListbox:c=defaultIsActiveElementInListbox,unstable_classNamePrefix:f="Mui",autoComplete:d=false,autoHighlight:p=false,autoSelect:g=false,blurOnSelect:h=false,clearOnBlur:b=!u.freeSolo,clearOnEscape:v=false,componentName:m="useAutocomplete",defaultValue:x=(u.multiple?[]:null),disableClearable:y=false,disableCloseOnSelect:O=false,disabled:k,disabledItemsFocusable:w=false,disableListWrap:D=false,filterOptions:E=l,filterSelectedOptions:I=false,freeSolo:A=false,getOptionDisabled:T,getOptionLabel:$=(e=>{var t;return(t=e.label)!=null?t:e}),groupBy:S,handleHomeEndKeys:C=!u.freeSolo,id:N,includeInputInList:L=false,inputValue:M,isOptionEqualToValue:V=((e,t)=>e===t),multiple:P=false,onChange:H,onClose:R,onHighlightChange:q,onInputChange:F,onOpen:U,open:_,openOnFocus:B=false,options:K,readOnly:z=false,selectOnFocus:j=!u.freeSolo,value:J}=u;const Y=n(N);let W=$;W=e=>{const t=$(e);if(typeof t!=="string"){if(process.env.NODE_ENV!=="production"){const n=t===void 0?"undefined":`${typeof t} (${t})`;console.error(`MUI: The \`getOptionLabel\` method of ${m} returned ${n} instead of a string for ${JSON.stringify(e)}.`)}return String(t)}return t};const X=t.useRef(false);const G=t.useRef(true);const Q=t.useRef(null);const Z=t.useRef(null);const[ee,te]=t.useState(null);const[ne,oe]=t.useState(-1);const re=p?0:-1;const se=t.useRef(re);const[ie,le]=o({controlled:J,default:x,name:m});const[ae,ue]=o({controlled:M,default:"",name:m,state:"inputValue"});const[ce,fe]=t.useState(false);const de=t.useCallback(((e,t)=>{const n=P?ie.length<t.length:t!==null;if(!n&&!b)return;let o;if(P)o="";else if(t==null)o="";else{const e=W(t);o=typeof e==="string"?e:""}if(ae!==o){ue(o);F&&F(e,o,"reset")}}),[W,ae,P,F,ue,b,ie]);const[pe,ge]=o({controlled:_,default:false,name:m,state:"open"});const[he,be]=t.useState(true);const ve=!P&&ie!=null&&ae===W(ie);const me=pe&&!z;const xe=me?E(K.filter((e=>!I||!(P?ie:[ie]).some((t=>t!==null&&V(e,t))))),{inputValue:ve&&he?"":ae,getOptionLabel:W}):[];const ye=r({filteredOptions:xe,value:ie,inputValue:ae});t.useEffect((()=>{const e=ie!==ye.value;ce&&!e||A&&!e||de(null,ie)}),[ie,de,ce,ye.value,A]);const Oe=pe&&xe.length>0&&!z;if(process.env.NODE_ENV!=="production"&&ie!==null&&!A&&K.length>0){const e=(P?ie:[ie]).filter((e=>!K.some((t=>V(t,e)))));e.length>0&&console.warn([`MUI: The value provided to ${m} is invalid.`,`None of the options match with \`${e.length>1?JSON.stringify(e):JSON.stringify(e[0])}\`.`,"You can use the `isOptionEqualToValue` prop to customize the equality test."].join("\n"))}const ke=s((e=>{e===-1?Q.current.focus():ee.querySelector(`[data-tag-index="${e}"]`).focus()}));t.useEffect((()=>{if(P&&ne>ie.length-1){oe(-1);ke(-1)}}),[ie,P,ne,ke]);function validOptionIndex(e,t){if(!Z.current||e<0||e>=xe.length)return-1;let n=e;while(true){const o=Z.current.querySelector(`[data-option-index="${n}"]`);const r=!w&&(!o||o.disabled||o.getAttribute("aria-disabled")==="true");if(o&&o.hasAttribute("tabindex")&&!r)return n;n=t==="next"?(n+1)%xe.length:(n-1+xe.length)%xe.length;if(n===e)return-1}}const we=s((({event:e,index:t,reason:n="auto"})=>{se.current=t;t===-1?Q.current.removeAttribute("aria-activedescendant"):Q.current.setAttribute("aria-activedescendant",`${Y}-option-${t}`);q&&q(e,t===-1?null:xe[t],n);if(!Z.current)return;const o=Z.current.querySelector(`[role="option"].${f}-focused`);if(o){o.classList.remove(`${f}-focused`);o.classList.remove(`${f}-focusVisible`)}let r=Z.current;Z.current.getAttribute("role")!=="listbox"&&(r=Z.current.parentElement.querySelector('[role="listbox"]'));if(!r)return;if(t===-1){r.scrollTop=0;return}const s=Z.current.querySelector(`[data-option-index="${t}"]`);if(s){s.classList.add(`${f}-focused`);n==="keyboard"&&s.classList.add(`${f}-focusVisible`);if(r.scrollHeight>r.clientHeight&&n!=="mouse"&&n!=="touch"){const e=s;const t=r.clientHeight+r.scrollTop;const n=e.offsetTop+e.offsetHeight;n>t?r.scrollTop=n-r.clientHeight:e.offsetTop-e.offsetHeight*(S?1.3:0)<r.scrollTop&&(r.scrollTop=e.offsetTop-e.offsetHeight*(S?1.3:0))}}}));const De=s((({event:e,diff:t,direction:n="next",reason:o="auto"})=>{if(!me)return;const getNextIndex=()=>{const e=xe.length-1;if(t==="reset")return re;if(t==="start")return 0;if(t==="end")return e;const n=se.current+t;return n<0?n===-1&&L?-1:D&&se.current!==-1||Math.abs(t)>1?0:e:n>e?n===e+1&&L?-1:D||Math.abs(t)>1?e:0:n};const r=validOptionIndex(getNextIndex(),n);we({index:r,reason:o,event:e});if(d&&t!=="reset")if(r===-1)Q.current.value=ae;else{const e=W(xe[r]);Q.current.value=e;const t=e.toLowerCase().indexOf(ae.toLowerCase());t===0&&ae.length>0&&Q.current.setSelectionRange(ae.length,e.length)}}));const checkHighlightedOptionExists=()=>{const isSameValue=(e,t)=>{const n=e?W(e):"";const o=t?W(t):"";return n===o};if(se.current!==-1&&ye.filteredOptions&&ye.filteredOptions.length!==xe.length&&ye.inputValue===ae&&(P?ie.length===ye.value.length&&ye.value.every(((e,t)=>W(ie[t])===W(e))):isSameValue(ye.value,ie))){const e=ye.filteredOptions[se.current];if(e){const t=xe.some((t=>W(t)===W(e)));if(t)return true}}return false};const Ee=t.useCallback((()=>{if(!me)return;if(checkHighlightedOptionExists())return;const e=P?ie[0]:ie;if(xe.length!==0&&e!=null){if(Z.current)if(e==null)se.current>=xe.length-1?we({index:xe.length-1}):we({index:se.current});else{const t=xe[se.current];if(P&&t&&findIndex(ie,(e=>V(t,e)))!==-1)return;const n=findIndex(xe,(t=>V(t,e)));n===-1?De({diff:"reset"}):we({index:n})}}else De({diff:"reset"})}),[xe.length,!P&&ie,I,De,we,me,ae,P]);const Ie=s((e=>{i(Z,e);e&&Ee()}));process.env.NODE_ENV!=="production"&&t.useEffect((()=>{Q.current&&Q.current.nodeName==="INPUT"||(Q.current&&Q.current.nodeName==="TEXTAREA"?console.warn([`A textarea element was provided to ${m} where input was expected.`,"This is not a supported scenario but it may work under certain conditions.","A textarea keyboard navigation may conflict with Autocomplete controls (e.g. enter and arrow keys).","Make sure to test keyboard navigation and add custom event handlers if necessary."].join("\n")):console.error([`MUI: Unable to find the input element. It was resolved to ${Q.current} while an HTMLInputElement was expected.`,`Instead, ${m} expects an input element.`,"",m==="useAutocomplete"?"Make sure you have bound getInputProps correctly and that the normal ref/effect resolutions order is guaranteed.":"Make sure you have customized the input component correctly."].join("\n")))}),[m]);t.useEffect((()=>{Ee()}),[Ee]);const handleOpen=e=>{if(!pe){ge(true);be(true);U&&U(e)}};const handleClose=(e,t)=>{if(pe){ge(false);R&&R(e,t)}};const handleValue=(e,t,n,o)=>{if(P){if(ie.length===t.length&&ie.every(((e,n)=>e===t[n])))return}else if(ie===t)return;H&&H(e,t,n,o);le(t)};const Ae=t.useRef(false);const selectNewValue=(e,t,n="selectOption",o="options")=>{let r=n;let s=t;if(P){s=Array.isArray(ie)?ie.slice():[];if(process.env.NODE_ENV!=="production"){const e=s.filter((e=>V(t,e)));e.length>1&&console.error([`MUI: The \`isOptionEqualToValue\` method of ${m} does not handle the arguments correctly.`,`The component expects a single value to match a given option but found ${e.length} matches.`].join("\n"))}const e=findIndex(s,(e=>V(t,e)));if(e===-1)s.push(t);else if(o!=="freeSolo"){s.splice(e,1);r="removeOption"}}de(e,s);handleValue(e,s,r,{option:t});O||e&&(e.ctrlKey||e.metaKey)||handleClose(e,r);(h===true||h==="touch"&&Ae.current||h==="mouse"&&!Ae.current)&&Q.current.blur()};function validTagIndex(e,t){if(e===-1)return-1;let n=e;while(true){if(t==="next"&&n===ie.length||t==="previous"&&n===-1)return-1;const e=ee.querySelector(`[data-tag-index="${n}"]`);if(e&&e.hasAttribute("tabindex")&&!e.disabled&&e.getAttribute("aria-disabled")!=="true")return n;n+=t==="next"?1:-1}}const handleFocusTag=(e,t)=>{if(!P)return;ae===""&&handleClose(e,"toggleInput");let n=ne;if(ne===-1)ae===""&&t==="previous"&&(n=ie.length-1);else{n+=t==="next"?1:-1;n<0&&(n=0);n===ie.length&&(n=-1)}n=validTagIndex(n,t);oe(n);ke(n)};const handleClear=e=>{X.current=true;ue("");F&&F(e,"","clear");handleValue(e,P?[]:null,"clear")};const handleKeyDown=e=>t=>{e.onKeyDown&&e.onKeyDown(t);if(!t.defaultMuiPrevented){if(ne!==-1&&["ArrowLeft","ArrowRight"].indexOf(t.key)===-1){oe(-1);ke(-1)}if(t.which!==229)switch(t.key){case"Home":if(me&&C){t.preventDefault();De({diff:"start",direction:"next",reason:"keyboard",event:t})}break;case"End":if(me&&C){t.preventDefault();De({diff:"end",direction:"previous",reason:"keyboard",event:t})}break;case"PageUp":t.preventDefault();De({diff:-a,direction:"previous",reason:"keyboard",event:t});handleOpen(t);break;case"PageDown":t.preventDefault();De({diff:a,direction:"next",reason:"keyboard",event:t});handleOpen(t);break;case"ArrowDown":t.preventDefault();De({diff:1,direction:"next",reason:"keyboard",event:t});handleOpen(t);break;case"ArrowUp":t.preventDefault();De({diff:-1,direction:"previous",reason:"keyboard",event:t});handleOpen(t);break;case"ArrowLeft":handleFocusTag(t,"previous");break;case"ArrowRight":handleFocusTag(t,"next");break;case"Enter":if(se.current!==-1&&me){const e=xe[se.current];const n=!!T&&T(e);t.preventDefault();if(n)return;selectNewValue(t,e,"selectOption");d&&Q.current.setSelectionRange(Q.current.value.length,Q.current.value.length)}else if(A&&ae!==""&&ve===false){P&&t.preventDefault();selectNewValue(t,ae,"createOption","freeSolo")}break;case"Escape":if(me){t.preventDefault();t.stopPropagation();handleClose(t,"escape")}else if(v&&(ae!==""||P&&ie.length>0)){t.preventDefault();t.stopPropagation();handleClear(t)}break;case"Backspace":if(P&&!z&&ae===""&&ie.length>0){const e=ne===-1?ie.length-1:ne;const n=ie.slice();n.splice(e,1);handleValue(t,n,"removeOption",{option:ie[e]})}break;case"Delete":if(P&&!z&&ae===""&&ie.length>0&&ne!==-1){const e=ne;const n=ie.slice();n.splice(e,1);handleValue(t,n,"removeOption",{option:ie[e]})}break;default:}}};const handleFocus=e=>{fe(true);B&&!X.current&&handleOpen(e)};const handleBlur=e=>{if(c(Z))Q.current.focus();else{fe(false);G.current=true;X.current=false;g&&se.current!==-1&&me?selectNewValue(e,xe[se.current],"blur"):g&&A&&ae!==""?selectNewValue(e,ae,"blur","freeSolo"):b&&de(e,ie);handleClose(e,"blur")}};const handleInputChange=e=>{const t=e.target.value;if(ae!==t){ue(t);be(false);F&&F(e,t,"input")}t===""?y||P||handleValue(e,null,"clear"):handleOpen(e)};const handleOptionMouseMove=e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));se.current!==t&&we({event:e,index:t,reason:"mouse"})};const handleOptionTouchStart=e=>{we({event:e,index:Number(e.currentTarget.getAttribute("data-option-index")),reason:"touch"});Ae.current=true};const handleOptionClick=e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));selectNewValue(e,xe[t],"selectOption");Ae.current=false};const handleTagDelete=e=>t=>{const n=ie.slice();n.splice(e,1);handleValue(t,n,"removeOption",{option:ie[e]})};const handlePopupIndicator=e=>{pe?handleClose(e,"toggleInput"):handleOpen(e)};const handleMouseDown=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute("id")!==Y&&e.preventDefault()};const handleClick=e=>{if(e.currentTarget.contains(e.target)){Q.current.focus();j&&G.current&&Q.current.selectionEnd-Q.current.selectionStart===0&&Q.current.select();G.current=false}};const handleInputMouseDown=e=>{k||ae!==""&&pe||handlePopupIndicator(e)};let Te=A&&ae.length>0;Te=Te||(P?ie.length>0:ie!==null);let $e=xe;if(S){const e=new Map;let t=false;$e=xe.reduce(((n,o,r)=>{const s=S(o);if(n.length>0&&n[n.length-1].group===s)n[n.length-1].options.push(o);else{if(process.env.NODE_ENV!=="production"){if(e.get(s)&&!t){console.warn(`MUI: The options provided combined with the \`groupBy\` method of ${m} returns duplicated headers.`,"You can solve the issue by sorting the options with the output of `groupBy`.");t=true}e.set(s,true)}n.push({key:r,index:r,group:s,options:[o]})}return n}),[])}k&&ce&&handleBlur();return{getRootProps:(t={})=>e({"aria-owns":Oe?`${Y}-listbox`:null},t,{onKeyDown:handleKeyDown(t),onMouseDown:handleMouseDown,onClick:handleClick}),getInputLabelProps:()=>({id:`${Y}-label`,htmlFor:Y}),getInputProps:()=>({id:Y,value:ae,onBlur:handleBlur,onFocus:handleFocus,onChange:handleInputChange,onMouseDown:handleInputMouseDown,"aria-activedescendant":me?"":null,"aria-autocomplete":d?"both":"list","aria-controls":Oe?`${Y}-listbox`:void 0,"aria-expanded":Oe,autoComplete:"off",ref:Q,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:k}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:handleClear}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:handlePopupIndicator}),getTagProps:({index:t})=>e({key:t,"data-tag-index":t,tabIndex:-1},!z&&{onDelete:handleTagDelete(t)}),getListboxProps:()=>({role:"listbox",id:`${Y}-listbox`,"aria-labelledby":`${Y}-label`,ref:Ie,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:({index:e,option:t})=>{const n=(P?ie:[ie]).some((e=>e!=null&&V(t,e)));const o=!!T&&T(t);return{key:W(t),tabIndex:-1,role:"option",id:`${Y}-option-${e}`,onMouseMove:handleOptionMouseMove,onClick:handleOptionClick,onTouchStart:handleOptionTouchStart,"data-option-index":e,"aria-disabled":o,"aria-selected":n}},id:Y,inputValue:ae,value:ie,dirty:Te,expanded:me&&ee,popupOpen:me,focused:ce||ne!==-1,anchorEl:ee,setAnchorEl:te,focusedTag:ne,groupedOptions:$e}}"use client";export{createFilterOptions,useAutocomplete};

